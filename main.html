<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>covid-19 Metadata Template</title>
    <link rel="stylesheet" href="main.css">
  </head>
  <body>
    <!-- flex grid -->
    <div class="container-fluid">
      <!-- buttons above Handsontable grid -->
      <div class="row mt-3" id="header-row">
        <div class="col">
          <div class="btn-group" role="group">
            <div class="btn-group" role="group">
              <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">File</button>
              <div class="dropdown-menu">
                <span class="dropdown-item" id="new-dropdown-item">New</span>
                <label for="open-file-input" class="dropdown-item mb-0" id="open-dropdown-item">Open</label>
                <input type="file" accept=".xlsx,.xls,.tsv,.csv" class="form-control-file" id="open-file-input">
                <span class="dropdown-item" data-toggle="modal" data-target="#save-as-modal">Save As...</span>
                <span class="dropdown-item" data-toggle="modal" data-target="#export-to-modal">Export To...</span>
              </div>
            </div>
            <div class="btn-group" id="settings-dropdown-btn-group" role="group">
              <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Settings</button>
              <div class="dropdown-menu">
                <span class="dropdown-item hidden-dropdown-item" id="show-all-cols-dropdown-item">Show all columns</span>
                <span class="dropdown-item hidden-dropdown-item" id="show-required-cols-dropdown-item">Show required columns</span>
                <span class="dropdown-item hidden-dropdown-item" id="show-all-rows-dropdown-item">Show all rows</span>
                <span class="dropdown-item hidden-dropdown-item" id="show-valid-rows-dropdown-item">Show valid rows</span>
                <span class="dropdown-item hidden-dropdown-item" id="show-invalid-rows-dropdown-item">Show invalid rows</span>
                <span class="dropdown-item disabled" id="version-dropdown-item">Version 0.7.0</span>
              </div>
            </div>
            <button type="button" class="btn btn-primary" id="validate-btn">Validate</button>
          </div>
          <button type="button" class="btn btn-info d-none d-sm-inline" id="getting-started-btn" data-toggle="modal" data-target="#getting-started-modal">Getting Started</button>
        </div>
      </div>
      <!-- Handsontable grid -->
      <div class="row mt-3">
        <div class="col">
          <div id="grid"></div>
        </div>
      </div>
      <!-- Buttons below Handsontable grid -->
      <div class="row mt-3" id="footer-row">
        <div class="col col-md-6">
          <div class="input-group">
            <div class="input-group-prepend">
              <button class="btn btn-primary" id="add-rows-button" type="submit">Add</button>
            </div>
            <input type="text" class="form-control" id="add-rows-input" value="100">
            <div class="input-group-append">
              <span class="input-group-text">more rows at the bottom.</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Modals -->
    <div class="modal" id="clear-data-warning-modal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-body">
            <div class="container-fluid">
              <div class="row">
                <div class="col">
                  <span class="text-danger">Clear existing data?</span>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-2 col-sm-6"></div>
                <div class="col d-flex justify-content-end">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                </div>
                <div class="col d-flex justify-content-end">
                  <button type="button" class="btn btn-danger" id="clear-data-confirm-btn" data-dismiss="modal">Clear</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal" id="save-as-modal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-body">
            <div class="container-fluid">
              <div class="row">
                <div class="col text-danger" id="save-as-err-msg"></div>
              </div>
              <div class="row">
                <div class="col">
                  <div class="input-group">
                    <input type="text" class="form-control" id="base-name-save-as-input" placeholder="file name">
                    <div class="input-group-append">
                      <select class="form-control" id="file-ext-save-as-select">
                        <option value="xlsx" selected>.xlsx</option>
                        <option value="xls">.xls</option>
                        <option value="tsv">.tsv</option>
                        <option value="csv">.csv</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-2 col-sm-6"></div>
                <div class="col d-flex justify-content-end">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                </div>
                <div class="col d-flex justify-content-end">
                  <button type="button" class="btn btn-primary" id="save-as-confirm-btn">Save</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal" id="export-to-modal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-body">
            <div class="container-fluid">
              <div class="row">
                <div class="col text-danger" id="export-to-err-msg"></div>
              </div>
              <div class="row">
                <div class="col-12 col-sm-8">
                  <div class="input-group">
                    <input type="text" class="form-control" id="base-name-export-to-input" placeholder="file name">
                    <div class="input-group-append">
                      <div class="input-group-text">.xls</div>
                    </div>
                  </div>
                </div>
                <div class="col mt-2 mt-sm-0">
                  <select class="form-control" id="export-to-format-select">
                    <option value="" disabled selected>Format</option>
                    <option value="gisaid">GISAID</option>
                    <option value="irida">IRIDA</option>
                  </select>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col-2 col-sm-6"></div>
                <div class="col d-flex justify-content-end">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                </div>
                <div class="col d-flex justify-content-end">
                  <button type="button" class="btn btn-primary" id="export-to-confirm-btn">Export</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal" id="specify-headers-modal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-body">
            <div class="container-fluid">
              <div class="row">
                <div class="col">The second row in your imported file does not match the grid.</div>
              </div>
              <div class="row my-3 border" id="specify-headers-comparison-row">
                <div class="col">
                  <div class="row">
                    <div class="col"><b>Expected second row:</b></div>
                  </div>
                  <div class="row">
                    <div class="col">
                      <div id="expected-headers-div"></div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col"><b>Actual second row:</b></div>
                  </div>
                  <div class="row">
                    <div class="col">
                      <div id="actual-headers-div"></div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <p>We will try to map your headers. <b>Which row in your file has the column headers?</b></p>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <input class="form-control" id="specify-headers-input" value="2">
                </div>
              </div>
              <div class="row">
                <div class="col"><i>First row = 1, Second row = 2, etc.</i></div>
              </div>
              <div class="row">
                <div class="col text-danger" id="specify-headers-err-msg">Invalid row</div>
              </div>
              <div class="row mt-3">
                <div class="col d-flex justify-content-end">
                  <button type="button" class="btn btn-primary" id="specify-headers-confirm-btn">Ok</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal" id="open-error-modal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-body">
            <div class="container-fluid">
              <div class="row">
                <div class="col text-danger" id="open-err-msg"></div>
              </div>
              <div class="row mt-3">
                <div class="col d-flex justify-content-end">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Ok</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal" id="field-description-modal" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-body">
            <div class="container-fluid">
              <div class="row">
                <div class="col" id="field-description-text"></div>
              </div>
              <div class="row mt-3">
                <div class="col d-flex justify-content-end">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Ok</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal" id="getting-started-modal" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <div class="container-fluid">
              <div class="row">
                <div class="col">
                  <h5>Are you ready to harmonize your contextual data?</h5>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <a target="_blank" href="./SOP.pdf">Get the SOP</a>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-body">
            <div class="container-fluid">
              <div class="row">
                <div class="col">
                  <div class="carousel slide" id="getting-started-carousel" data-interval="false">
                    <ol class="carousel-indicators">
                      <li data-target="#getting-started-carousel" data-slide-to="0" class="active"></li>
                      <li data-target="#getting-started-carousel" data-slide-to="1"></li>
                      <li data-target="#getting-started-carousel" data-slide-to="2"></li>
                      <li data-target="#getting-started-carousel" data-slide-to="3"></li>
                      <li data-target="#getting-started-carousel" data-slide-to="4"></li>
                      <li data-target="#getting-started-carousel" data-slide-to="5"></li>
                    </ol>
                    <div class="carousel-inner">
                      <div class="carousel-item active">
                        <img class="d-block w-100" src="images/editCopyPasteDelete.gif">
                        <div class="carousel-caption">
                          <p>The contextual data collection template and validator application enables users to enter data as in an excel spreadsheet - type and pick values from dropdowns, copy/paste, add rows, etc.</p>
                        </div>
                      </div>
                      <div class="carousel-item">
                        <img class="d-block w-100" src="images/toggleRequiredCols.gif">
                        <div class="carousel-caption">
                          <p>Fields are colour-coded; required fields (minimal metadata) are yellow, strongly recommended fields are purple, optional fields are white.</p>
                          <p>You can toggle between all, and the required fields, by going to “Settings” and selecting “Show Required Columns”.</p>
                        </div>
                      </div>
                      <div class="carousel-item">
                        <img class="d-block w-100" src="images/doubleClickHeaders.gif">
                        <div class="carousel-caption">
                          <p>Double click on field headers to see the definition of the field, guidance on filling in the field, and examples of how data might look structured according to the constraints of the validator.</p>
                        </div>
                      </div>
                      <div class="carousel-item">
                        <img class="d-block w-100" src="images/selectingVals.gif">
                        <div class="carousel-caption">
                          <p>Picklists of controlled vocabulary are available for many fields. There are dropdown menus for some, and multi-select options for others (e.g. Signs and Symptoms). You can also see the list of terms in multi-select columns by clicking once in the multi-select box.</p>
                        </div>
                      </div>
                      <div class="carousel-item">
                        <img class="d-block w-100" src="images/validatingCells.gif">
                        <div class="carousel-caption">
                          <p>When you’re done entering your data, you can validate values by clicking on “Validate”. Errors and missing information in required fields will be coloured red.</p>
                        </div>
                      </div>
                      <div class="carousel-item">
                        <img class="d-block w-100" src="images/exportingFiles.gif">
                        <div class="carousel-caption">
                          <p>When you’ve entered and validated your data, you can save it as a .xlsx, .xls, .tsv or csv format file, by clicking on “File” followed by “Save as”. You can also format your data for IRIDA upload (you will need to perform the upload yourself), or use your entered data to create a GISAID submission form (you will need to add additional information, and perform the upload yourself), by clicking on "File" followed by "Export to".</p>
                          <p><i>If you have questions, or require assistance, contact emma.griffiths@bccdc.ca.</i></p>
                        </div>
                      </div>
                    </div>
                    <a class="carousel-control-prev" href="#getting-started-carousel" role="button" data-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                       <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#getting-started-carousel" role="button" data-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                    </a>
                  </div>
                </div>
              </div>
              <div class="row mt-3">
                <div class="col d-flex justify-content-end">
                  <button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- External libraries -->
    <script src="libraries/jquery-3.5.1.slim.min.js"></script>
    <script src="libraries/popper.min.js"></script>
    <script src="libraries/bootstrap.min.js"></script>
    <script src="libraries/handsontable.full.min.js"></script>
    <script type="text/javascript" src="libraries/shim.min.js"></script>
    <script type="text/javascript" src="libraries/xlsx.full.min.js"></script>
    <script type="text/javascript" src="libraries/chosen.jquery.min.js"></script>
    <script type="text/javascript" src="libraries/moment.min.js"></script>
    <script src="data.js"></script>
    <script src="main.js"></script>
  </body>
</html>
